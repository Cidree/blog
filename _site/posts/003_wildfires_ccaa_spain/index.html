<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Adrián Cidre">
<meta name="dcterms.date" content="2023-11-18">
<title>Adrián Cidre - Spanish Wildfires by CCAA during 2006-2015</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-J58431JK0F"></script><script type="text/plain" cookie-consent="tracking">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-J58431JK0F', { 'anonymize_ip': true});
</script><script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"interstitial",
  "consent_type":"implied",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  });
});
</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="../../00_styles/styles.css">
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Adrián Cidre</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects.html" rel="" target="">
 <span class="menu-text">Posts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../courses.html" rel="" target="">
 <span class="menu-text">Courses</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/Cidree" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/adrian-cidre-gonz%C3%A1lez-8a50371b0/" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:adrian.cidre@gmail.com" rel="" target=""><i class="bi bi-envelope-at" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
<div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><header id="title-block-header" class="quarto-title-block default page-columns page-full"><div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Spanish Wildfires by CCAA during 2006-2015</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">R</div>
                <div class="quarto-category">forestry</div>
                <div class="quarto-category">wildfires</div>
                <div class="quarto-category">ggplot2</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Adrián Cidre </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">November 18, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of Contents</h2>
   
  <ul>
<li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">2.1</span> Introduction</a></li>
  <li><a href="#loading-packages" id="toc-loading-packages" class="nav-link" data-scroll-target="#loading-packages"><span class="header-section-number">2.2</span> Loading packages</a></li>
  <li><a href="#data-exploration" id="toc-data-exploration" class="nav-link" data-scroll-target="#data-exploration"><span class="header-section-number">2.3</span> Data exploration</a></li>
  <li>
<a href="#analysing-the-number-of-wildfires" id="toc-analysing-the-number-of-wildfires" class="nav-link" data-scroll-target="#analysing-the-number-of-wildfires"><span class="header-section-number">2.4</span> Analysing the number of wildfires</a>
  <ul class="collapse">
<li><a href="#analysing-the-results" id="toc-analysing-the-results" class="nav-link" data-scroll-target="#analysing-the-results"><span class="header-section-number">2.4.1</span> Analysing the results</a></li>
  </ul>
</li>
  <li>
<a href="#analysing-the-spatial-distribution" id="toc-analysing-the-spatial-distribution" class="nav-link" data-scroll-target="#analysing-the-spatial-distribution"><span class="header-section-number">2.5</span> Analysing the spatial distribution</a>
  <ul class="collapse">
<li><a href="#analysing-the-results-1" id="toc-analysing-the-results-1" class="nav-link" data-scroll-target="#analysing-the-results-1"><span class="header-section-number">2.5.1</span> Analysing the results</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content"><blockquote class="blockquote">
<h1 id="spanish-wildfires-by-autonomous-communities" data-number="2">
<span class="header-section-number">2</span> Spanish Wildfires by Autonomous Communities</h1>
</blockquote>
<section id="introduction" class="level2" data-number="2.1"><h2 data-number="2.1" class="anchored" data-anchor-id="introduction">
<span class="header-section-number">2.1</span> Introduction</h2>
<p>In this post, we will explore the distribution of the forest wildfires in Spain by Autonomous Community, creating some descriptive graphs using R and <code>ggplot2</code>.</p>
<p>The data was obtained from the MITECO (Ministerio para la Transición Ecológica y el Reto Demográfico), and it can be found in this <a href="https://www.miteco.gob.es/es/biodiversidad/servicios/banco-datos-naturaleza/informacion-disponible/incendios-forestales.html">link</a>.</p>
<p>I will use the data for the decade 2005-2015, which is the latest available database for this purpose.</p>
</section><section id="loading-packages" class="level2" data-number="2.2"><h2 data-number="2.2" class="anchored" data-anchor-id="loading-packages">
<span class="header-section-number">2.2</span> Loading packages</h2>
<p>First, we will load some packages:</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/trinker/pacman">pacman</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span></span>
<span>  <span class="co">## Core</span></span>
<span>  <span class="va">tidyverse</span>, <span class="va">readxl</span>, <span class="va">stringi</span>,</span>
<span>  </span>
<span>  <span class="co">## Vectorial data manipulation</span></span>
<span>  <span class="va">sf</span>,</span>
<span>  </span>
<span>  <span class="co">## Download data</span></span>
<span>  <span class="va">mapSpain</span>,</span>
<span>  </span>
<span>  <span class="co">## Visualization</span></span>
<span>  <span class="va">RColorBrewer</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here, I will use the <code>tidyverse</code> as usual for data analysis and visualization, the package <code>readxl</code> since the data is in <em>Excel</em> format, and <code>stringi</code> for some string manipulation. Then, the package <code>sf</code> for vectorial data manipulation, <code>mapSpain</code> to download the map of Spain by any NUTS level. Finally, I will use <code>RColorBrewer</code> for colour palettes.</p>
</section><section id="data-exploration" class="level2" data-number="2.3"><h2 data-number="2.3" class="anchored" data-anchor-id="data-exploration">
<span class="header-section-number">2.3</span> Data exploration</h2>
<p>Once the packages are loaded, we can load the data. Note that the data is on the <span class="math inline">\(3^{rd}\)</span> sheet of the <em>Excel</em> file. The variables are in Spanish, so I will change some names to English so we can all understand what’s going on.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Load the data</span></span>
<span><span class="va">wildfires_tbl</span> <span class="op">&lt;-</span> <span class="fu">read_excel</span><span class="op">(</span><span class="st">"wildfires_2006_2015.xlsx"</span>, sheet <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> </span>
<span></span>
<span><span class="co">## Set new names</span></span>
<span><span class="va">wildfires_tbl</span> <span class="op">&lt;-</span> <span class="va">wildfires_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span>municipality <span class="op">=</span> <span class="va">NOMBRE</span>, ccaa <span class="op">=</span> <span class="va">COM_N_INE</span>, small_fires <span class="op">=</span> <span class="va">conatos</span>, wildfires <span class="op">=</span> <span class="va">incendios</span>, </span>
<span>         total_wildires <span class="op">=</span> <span class="va">TOTAL_INCENDIOS</span>, woodland_area <span class="op">=</span> <span class="va">ARBOLADO</span>, </span>
<span>         treeless_area <span class="op">=</span> <span class="va">NOARBOLADO</span>, total_area <span class="op">=</span> <span class="va">TOTAL</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Overview of the data</span></span>
<span><span class="fu">glimpse</span><span class="op">(</span><span class="va">wildfires_tbl</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 4,376
Columns: 8
$ municipality   &lt;chr&gt; "A Arnoia", "A Baña", "A Bola", "A Cañiza", "A Capela",…
$ ccaa           &lt;chr&gt; "Galicia", "Galicia", "Galicia", "Galicia", "Galicia", …
$ small_fires    &lt;dbl&gt; 27, 66, 74, 330, 12, 149, 156, 75, 33, 426, 30, 58, 86,…
$ wildfires      &lt;dbl&gt; 3, 37, 12, 81, 6, 24, 54, 47, 4, 273, 3, 62, 28, 16, 28…
$ total_wildires &lt;dbl&gt; 30, 103, 86, 411, 18, 173, 210, 122, 37, 699, 33, 120, …
$ woodland_area  &lt;dbl&gt; 30, 615, 16, 978, 394, 18, 262, 600, 8, 803, 30, 364, 6…
$ treeless_area  &lt;dbl&gt; 8, 82, 61, 1260, 165, 104, 791, 641, 17, 3395, 6, 1558,…
$ total_area     &lt;dbl&gt; 38, 697, 77, 2238, 559, 122, 1053, 1241, 25, 4198, 36, …</code></pre>
</div>
</div>
<p>So we can see that there is data about the number of wildfires, and the area burned. This week we will study the number of wildfires and the next week we will have a look to the area burned and their relationship.</p>
<p>There are a total of 4,376 observations, where each observation stands for a single municipality (therefore, the column municipality can be thought as the ID). Then, we have the Autonomous Community (<em>ccaa</em>) to which the municipality belongs, the number of fires, and the burned area. To those who are not familiarized with the concept of “<em>conato</em>”, which I translated as small fire, this is:</p>
<blockquote class="blockquote">
<p><strong>Conato</strong>: wildfires where the total burned area is less than 1 hectare. This definition applies to the data here; however, in some Autonomous Communities the definition may be different. For instance, in Galicia they consider that less than 0.5 hectares must be woodland area, otherwise, it is categorized as normal wildfire.</p>
</blockquote>
<p>There is also another category called <em>Grandes Incendios Forestales</em> (Large Forest Fires), which are those that burn more than 500 hectares. However, they did not consider this category in the data.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you are interested, the first two sheets of the Excel file contain some metadata and information about the variables.</p>
</div>
</div>
</section><section id="analysing-the-number-of-wildfires" class="level2" data-number="2.4"><h2 data-number="2.4" class="anchored" data-anchor-id="analysing-the-number-of-wildfires">
<span class="header-section-number">2.4</span> Analysing the number of wildfires</h2>
<p>Let’s do some data wrangling! Since we will analyse the wildfires by Autonomous Community, we need to summarise our data using the <em>ccaa</em> variable. So this can be easily done as follows:</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">wildfires_ccaa_tbl</span> <span class="op">&lt;-</span> <span class="va">wildfires_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">ccaa</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    total_wildfires <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">total_wildires</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">wildfires_ccaa_tbl</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 17 × 2
   ccaa                       total_wildfires
   &lt;chr&gt;                                &lt;dbl&gt;
 1 Andalucia                             7519
 2 Aragon                                3055
 3 Canarias                               954
 4 Cantabria                             6257
 5 Castilla y Leon                      16421
 6 Castilla-La Mancha                    6725
 7 Cataluña                              3751
 8 Comunidad Foral de Navarra            4577
 9 Comunidad de Madrid                   2657
10 Comunitat Valenciana                  3349
11 Extremadura                           8148
12 Galicia                              37870
13 Illes Balears                         1031
14 La Rioja                               634
15 Pais Vasco                             913
16 Principado de Asturias               16979
17 Region de Murcia                      1157</code></pre>
</div>
</div>
<p>Cool. This starts to look pretty good, but we need to apply some formatting. First, we can order the Autonomous Communities by descending order of the total wildfires, and create a label with the percentages format.</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">wildfires_ccaa_total_tbl</span> <span class="op">&lt;-</span> <span class="va">wildfires_ccaa_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    ccaa       <span class="op">=</span> <span class="fu">fct_reorder</span><span class="op">(</span><span class="va">ccaa</span>, <span class="va">total_wildfires</span><span class="op">)</span>,</span>
<span>    label_perc <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/percent_format.html">percent</a></span><span class="op">(</span><span class="va">total_wildfires</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">total_wildfires</span><span class="op">)</span>,</span>
<span>                                 accuracy <span class="op">=</span> <span class="fl">.01</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">total_wildfires</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">wildfires_ccaa_total_tbl</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 17 × 3
   ccaa                       total_wildfires label_perc
   &lt;fct&gt;                                &lt;dbl&gt; &lt;chr&gt;     
 1 Galicia                              37870 31.04%    
 2 Principado de Asturias               16979 13.92%    
 3 Castilla y Leon                      16421 13.46%    
 4 Extremadura                           8148 6.68%     
 5 Andalucia                             7519 6.16%     
 6 Castilla-La Mancha                    6725 5.51%     
 7 Cantabria                             6257 5.13%     
 8 Comunidad Foral de Navarra            4577 3.75%     
 9 Cataluña                              3751 3.07%     
10 Comunitat Valenciana                  3349 2.75%     
11 Aragon                                3055 2.50%     
12 Comunidad de Madrid                   2657 2.18%     
13 Region de Murcia                      1157 0.95%     
14 Illes Balears                         1031 0.85%     
15 Canarias                               954 0.78%     
16 Pais Vasco                             913 0.75%     
17 La Rioja                               634 0.52%     </code></pre>
</div>
</div>
<p>Now this looks much better! With the function <code><a href="https://scales.r-lib.org/reference/percent_format.html">scales::percent</a></code> we can do the trick to create a character column with the percentage of wildfires over the total, and with the argument <code>accuracy</code> we specify the decimals. The <code>fct_reorder</code> function is used to order the levels of the Autonomous Communities (which is necessary for visualize in this order).</p>
<p>Now that we have the data ready, we can create a cool visualization to explore the data better:</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">wildfires_ccaa_total_tbl</span>  <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">ccaa</span>, y <span class="op">=</span> <span class="va">total_wildfires</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_col</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_label</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">label_perc</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">expand_limits</span><span class="op">(</span>y <span class="op">=</span> <span class="fl">40000</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x        <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>       y        <span class="op">=</span> <span class="st">"Total Wildfires"</span>,</span>
<span>       title    <span class="op">=</span> <span class="st">"Wildfires by Autonomous Community (2006-2015)"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Top 10 Autonomous Communities in Spain"</span>,</span>
<span>       caption  <span class="op">=</span> <span class="st">"Author: Adrián Cidre González"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span></span>
<span>    <span class="st">"rect"</span>, xmin <span class="op">=</span> <span class="fl">7.5</span>, xmax <span class="op">=</span> <span class="fl">10.5</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="fl">500</span>, ymax <span class="op">=</span> <span class="fl">41000</span>,</span>
<span>    fill <span class="op">=</span> <span class="cn">NA</span>, color <span class="op">=</span> <span class="st">"indianred4"</span>, lwd <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span></span>
<span>    <span class="st">"text"</span>,</span>
<span>    x <span class="op">=</span> <span class="fl">8.5</span>, y <span class="op">=</span> <span class="fl">30000</span>, </span>
<span>    label <span class="op">=</span> <span class="st">"The northwest of Spain \nsuffers the 58% of \nthe wildfires"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"indianred4"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>        plot.subtitle <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="index_files/figure-html/unnamed-chunk-5-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Ok, that was quite a bit of code. First, we can see that I filtered the top 10 Autonomous Communities with <code>head</code>. Then, we have a bar plot with the label that we previously created. The <code>expand_limits</code> function expands the axis so the label of Galicia can be seen properly. Next, the <code>annotate</code> functions create the rectangle and the label on the text. Note that we need to specify the geom of the annotation (in these cases <em>rect</em> and <em>text</em>). The rest of the arguments are just formatting. Isn’t it cool? That’s why I love <code>ggplot2</code> ❤️.</p>
<section id="analysing-the-results" class="level3" data-number="2.4.1"><h3 data-number="2.4.1" class="anchored" data-anchor-id="analysing-the-results">
<span class="header-section-number">2.4.1</span> Analysing the results</h3>
<p>There is an Autonomous Community were the number of fires are extremely high, Galicia. Almost one third of the Spanish burned area during the decade 2006-2015 was in this region, which in fact only occupies 5.8% of the territory of Spain. Next, we have Asturias with almost 14% of the total burned area, and occupying the 2.1% of the territory. To finish the top-3, we have Castilla and León where a similar area to Asturias was burned. However, Castilla and Leon is the biggest Autonomous Community of Spain representing the 18.6% of the territory. These numbers are alarming, and more when we look at the spatial location of these areas. The top-3 areas, representing the 58% of the burned area, are all located in the North-Western area of Spain.</p>
</section></section><section id="analysing-the-spatial-distribution" class="level2" data-number="2.5"><h2 data-number="2.5" class="anchored" data-anchor-id="analysing-the-spatial-distribution">
<span class="header-section-number">2.5</span> Analysing the spatial distribution</h2>
<p>To analyse the spatial distribution we need to get the vectorial data of the Autonomous Communities of Spain. One way is to use the package <code>mapSpain</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">esp_ccaa_sf</span> <span class="op">&lt;-</span> <span class="fu">esp_get_ccaa</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="va">iso2.ccaa.name.es</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Melilla"</span>, <span class="st">"Ceuta"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>With that code I am eliminating Ceuta and Melilla, because they are not included in the wildfires dataset. The next step is to join the <code>esp_ccaa_sf</code> and <code>wildfires_ccaa_total_tbl</code>; however, there’s an issue:</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">esp_ccaa_sf</span><span class="op">$</span><span class="va">nuts2.name</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Andalucía"                  "Aragón"                    
 [3] "Principado de Asturias"     "Illes Balears"             
 [5] "Canarias"                   "Cantabria"                 
 [7] "Castilla y León"            "Castilla-La Mancha"        
 [9] "Cataluña"                   "Comunidad Valenciana"      
[11] "Extremadura"                "Galicia"                   
[13] "Comunidad de Madrid"        "Región de Murcia"          
[15] "Comunidad Foral de Navarra" "País Vasco"                
[17] "La Rioja"                  </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">wildfires_ccaa_total_tbl</span><span class="op">$</span><span class="va">ccaa</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] Galicia                    Principado de Asturias    
 [3] Castilla y Leon            Extremadura               
 [5] Andalucia                  Castilla-La Mancha        
 [7] Cantabria                  Comunidad Foral de Navarra
 [9] Cataluña                   Comunitat Valenciana      
[11] Aragon                     Comunidad de Madrid       
[13] Region de Murcia           Illes Balears             
[15] Canarias                   Pais Vasco                
[17] La Rioja                  
17 Levels: La Rioja Pais Vasco Canarias Illes Balears ... Galicia</code></pre>
</div>
</div>
<p>Do you see it? The names are different, so that might be a problem when we try to join them. In the wildfires dataset, they didn’t use acute accent (e.g.&nbsp;á). We could manually change it, but the package <code>stringi</code> allows us to this more efficiently:</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">esp_ccaa_sf</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>nuts2.name <span class="op">=</span> <span class="va">nuts2.name</span> <span class="op">%&gt;%</span> <span class="fu">stri_trans_general</span><span class="op">(</span><span class="st">"Latin-ASCII"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pull</span><span class="op">(</span><span class="va">nuts2.name</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Andalucia"                  "Aragon"                    
 [3] "Principado de Asturias"     "Illes Balears"             
 [5] "Canarias"                   "Cantabria"                 
 [7] "Castilla y Leon"            "Castilla-La Mancha"        
 [9] "Cataluna"                   "Comunidad Valenciana"      
[11] "Extremadura"                "Galicia"                   
[13] "Comunidad de Madrid"        "Region de Murcia"          
[15] "Comunidad Foral de Navarra" "Pais Vasco"                
[17] "La Rioja"                  </code></pre>
</div>
</div>
<p>That’s a first approach, but now we need to manually change Calatuna to Cataluña, and also Comunidad Valenciana, which was previously already different. So all the changes will be achieved as follows:</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">##</span></span>
<span><span class="va">wildfires_ccaa_sf</span> <span class="op">&lt;-</span> <span class="va">esp_ccaa_sf</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>nuts2.name <span class="op">=</span> <span class="va">nuts2.name</span> <span class="op">%&gt;%</span> <span class="fu">stri_trans_general</span><span class="op">(</span><span class="st">"Latin-ASCII"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>nuts2.name <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span></span>
<span>    <span class="va">nuts2.name</span> <span class="op">==</span> <span class="st">"Comunidad Valenciana"</span> <span class="op">~</span> <span class="st">"Comunitat Valenciana"</span>,</span>
<span>    <span class="va">nuts2.name</span> <span class="op">==</span> <span class="st">"Cataluna"</span> <span class="op">~</span> <span class="st">"Cataluña"</span>,</span>
<span>    .default <span class="op">=</span> <span class="va">nuts2.name</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">inner_join</span><span class="op">(</span></span>
<span>    <span class="va">wildfires_ccaa_total_tbl</span>,</span>
<span>    by <span class="op">=</span> <span class="fu">join_by</span><span class="op">(</span><span class="va">nuts2.name</span> <span class="op">==</span> <span class="va">ccaa</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">nuts2.name</span>, <span class="va">total_wildfires</span><span class="op">)</span></span>
<span></span>
<span><span class="va">wildfires_ccaa_sf</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 17 features and 2 fields
Geometry type: GEOMETRY
Dimension:     XY
Bounding box:  xmin: -13.21924 ymin: 34.70209 xmax: 4.320511 ymax: 43.78793
Geodetic CRS:  ETRS89
First 10 features:
               nuts2.name total_wildfires                       geometry
1               Andalucia            7519 MULTIPOLYGON (((-4.268895 3...
2                  Aragon            3055 POLYGON ((-0.724501 42.9201...
3  Principado de Asturias           16979 MULTIPOLYGON (((-4.512301 4...
4           Illes Balears            1031 MULTIPOLYGON (((3.176714 39...
5                Canarias             954 MULTIPOLYGON (((-11.18653 3...
6               Cantabria            6257 MULTIPOLYGON (((-3.153338 4...
7         Castilla y Leon           16421 MULTIPOLYGON (((-4.737023 4...
8      Castilla-La Mancha            6725 MULTIPOLYGON (((-2.05169 41...
9                Cataluña            3751 MULTIPOLYGON (((0.858215 42...
10   Comunitat Valenciana            3349 MULTIPOLYGON (((0.17079 40....</code></pre>
</div>
</div>
<p>There, the <code>inner_join</code> function uses now the both columns to create a new table which the data together.</p>
<p>Up to this point, we can improve the visualization by creating some breaks:</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">wildfires_ccaa_sf</span> <span class="op">&lt;-</span> <span class="va">wildfires_ccaa_sf</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    total_wildfires <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span></span>
<span>      <span class="va">wildfires_ccaa_sf</span><span class="op">$</span><span class="va">total_wildfires</span>, </span>
<span>      breaks  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1000</span>, <span class="fl">3000</span>, <span class="fl">5000</span>, <span class="fl">10000</span>, <span class="fl">20000</span>, <span class="fl">40000</span><span class="op">)</span>,</span>
<span>      dig.lab <span class="op">=</span> <span class="fl">5</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>By doing this, we split the continuous variable of number of wildfires in a discrete variable divided into bins. That can improve some visualizations when the values are very different, and specially to catch outliers.</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">wildfires_ccaa_sf</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_sf</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">total_wildfires</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_brewer</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"RdYlGn"</span>, direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title    <span class="op">=</span> <span class="st">"Number of Wildfires by CCAA"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Period: 2006-2015"</span>,</span>
<span>    fill     <span class="op">=</span> <span class="st">"Wildfires"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>        plot.subtitle <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>        legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="index_files/figure-html/unnamed-chunk-12-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="index_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<section id="analysing-the-results-1" class="level3" data-number="2.5.1"><h3 data-number="2.5.1" class="anchored" data-anchor-id="analysing-the-results-1">
<span class="header-section-number">2.5.1</span> Analysing the results</h3>
<p>We can now confirm that the North-Western area of Spain suffers a significantly higher number of wildfires (&gt;10.000) in comparison to other areas. In contrast, the Eastern area suffers a lesser number of fires, with the Vask Country and La Rioja as the Autonomous Communities which suffered the smallest number of wildfires during the period 2006-2015.</p>


</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><script src="https://utteranc.es/client.js" repo="Cidree/blogComments" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">Made with <a href="https://quarto.org/">Quarto</a></div>   
    <div class="nav-footer-center"><a href="mailto:adrian.cidre@gmail.com">Contact Adrián Cidre</a><div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right"><a href="https://github.com/Cidree/blog">Github Code Repo</a></div>
  </div>
</footer><script>var lightboxQuarto = GLightbox({"loop":true,"selector":".lightbox","openEffect":"zoom","descPosition":"bottom","closeEffect":"zoom"});</script>


</body></html>